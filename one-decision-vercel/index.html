<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>One Decision · Leadership Guide</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=Bebas+Neue&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html, body, #root { height: 100%; }
    body { background: #0d0b08; overflow-x: hidden; }
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(194,154,108,0.3); border-radius: 2px; }
    textarea { resize: none; scrollbar-width: thin; }
    textarea::placeholder { color: rgba(200,184,154,0.4); }
    textarea:focus { outline: none; }
    @keyframes fadeUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes pulse { 0%, 80%, 100% { opacity: 0.3; transform: scale(0.8); } 40% { opacity: 1; transform: scale(1); } }
    .message-in { animation: fadeUp 0.3s ease forwards; }
    .dot { animation: pulse 1.4s infinite; display: inline-block; width: 6px; height: 6px; border-radius: 50%; background: #c29a6c; margin: 0 2px; }
    .dot:nth-child(2) { animation-delay: 0.2s; }
    .dot:nth-child(3) { animation-delay: 0.4s; }
    .send-btn:hover:not(:disabled) { background: rgba(194,154,108,0.95) !important; }
    .send-btn:disabled { opacity: 0.35; cursor: not-allowed; }
    .starter-btn { background: rgba(255,255,255,0.04); border: 1px solid rgba(194,154,108,0.25); border-radius: 8px; padding: 12px 16px; color: #c8b89a; font-family: 'Crimson Text', Georgia, serif; font-size: 15px; text-align: left; cursor: pointer; line-height: 1.5; transition: all 0.2s ease; width: 100%; }
    .starter-btn:hover { background: rgba(194,154,108,0.1); border-color: rgba(194,154,108,0.5); color: #e8d5b7; }
    .input-box { display: flex; gap: 10px; align-items: flex-end; background: rgba(255,255,255,0.05); border: 1px solid rgba(194,154,108,0.25); border-radius: 12px; padding: 10px 10px 10px 16px; transition: border-color 0.2s; }
    .input-box:focus-within { border-color: rgba(194,154,108,0.5); }
    .chat-scroll { scrollbar-width: thin; scrollbar-color: rgba(194,154,108,0.3) transparent; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    const STARTERS = [
      "I have a team member who's underperforming but I keep avoiding the conversation.",
      "I'm doing everything myself because I don't trust my team to do it right.",
      "My team doesn't seem bought in to the direction I've set.",
      "I feel like I'm managing instead of leading but I don't know how to change it.",
    ];

    function BookIcon() {
      return (
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
          <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
        </svg>
      );
    }

    function SendIcon() {
      return (
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <line x1="22" y1="2" x2="11" y2="13"/>
          <polygon points="22 2 15 22 11 13 2 9 22 2"/>
        </svg>
      );
    }

    function App() {
      const [messages, setMessages] = useState([]);
      const [input, setInput] = useState("");
      const [loading, setLoading] = useState(false);
      const [started, setStarted] = useState(false);
      const bottomRef = useRef(null);
      const textareaRef = useRef(null);

      useEffect(() => {
        bottomRef.current?.scrollIntoView({ behavior: "smooth" });
      }, [messages, loading]);

      const adjustTextarea = () => {
        const el = textareaRef.current;
        if (!el) return;
        el.style.height = "auto";
        el.style.height = Math.min(el.scrollHeight, 120) + "px";
      };

      const sendMessage = async (text) => {
        const userText = (text || input).trim();
        if (!userText || loading) return;
        setStarted(true);
        setInput("");
        if (textareaRef.current) textareaRef.current.style.height = "auto";
        const newMessages = [...messages, { role: "user", content: userText }];
        setMessages(newMessages);
        setLoading(true);
        try {
          const response = await fetch("/api/chat", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ messages: newMessages }),
          });
          const data = await response.json();
          setMessages([...newMessages, { role: "assistant", content: data.reply }]);
        } catch (err) {
          setMessages([...newMessages, { role: "assistant", content: "Something went wrong. Try again." }]);
        } finally {
          setLoading(false);
        }
      };

      const handleKeyDown = (e) => {
        if (e.key === "Enter" && !e.shiftKey) { e.preventDefault(); sendMessage(); }
      };

      return (
        <div style={{ minHeight: "100vh", background: "#0d0b08", display: "flex", flexDirection: "column", alignItems: "center", fontFamily: "'Crimson Text', Georgia, serif" }}>
          <div style={{ width: "100%", borderBottom: "1px solid rgba(194,154,108,0.15)", padding: "18px 24px", display: "flex", alignItems: "center", gap: "12px", background: "rgba(0,0,0,0.5)", backdropFilter: "blur(12px)", position: "sticky", top: 0, zIndex: 10 }}>
            <div style={{ width: "36px", height: "36px", background: "rgba(194,154,108,0.12)", border: "1px solid rgba(194,154,108,0.35)", borderRadius: "8px", display: "flex", alignItems: "center", justifyContent: "center", color: "#c29a6c", flexShrink: 0 }}>
              <BookIcon />
            </div>
            <div>
              <div style={{ fontFamily: "'Bebas Neue', sans-serif", fontSize: "18px", letterSpacing: "2px", color: "#e8d5b7", lineHeight: 1 }}>ONE DECISION</div>
              <div style={{ fontSize: "11px", color: "rgba(194,154,108,0.6)", letterSpacing: "1px", textTransform: "uppercase", marginTop: "3px" }}>Leadership Guide · J. Michael Reynolds</div>
            </div>
          </div>

          <div className="chat-scroll" style={{ flex: 1, width: "100%", maxWidth: "720px", overflowY: "auto", padding: "32px 20px 0", display: "flex", flexDirection: "column", gap: "24px" }}>
            {!started && (
              <div className="message-in" style={{ display: "flex", flexDirection: "column", gap: "24px" }}>
                <div style={{ textAlign: "center", padding: "16px 0 4px" }}>
                  <div style={{ fontFamily: "'Bebas Neue', sans-serif", fontSize: "clamp(32px, 8vw, 46px)", letterSpacing: "4px", color: "#e8d5b7", lineHeight: 1 }}>LEAD OR STEP ASIDE</div>
                  <div style={{ fontStyle: "italic", fontSize: "17px", color: "rgba(194,154,108,0.75)", marginTop: "10px" }}>What situation are you navigating?</div>
                </div>
                <div style={{ height: "1px", background: "linear-gradient(to right, transparent, rgba(194,154,108,0.3), transparent)" }} />
                <p style={{ color: "rgba(200,184,154,0.6)", fontSize: "15px", lineHeight: "1.75", textAlign: "center" }}>
                  Describe what you're dealing with. Be specific. You'll get a direct response grounded in the principles from <em>One Decision</em> — not generic advice.
                </p>
                <div style={{ display: "flex", flexDirection: "column", gap: "10px" }}>
                  {STARTERS.map((p, i) => (
                    <button key={i} className="starter-btn" onClick={() => sendMessage(p)}>"{p}"</button>
                  ))}
                </div>
              </div>
            )}

            {messages.map((msg, i) => (
              <div key={i} className="message-in" style={{ display: "flex", flexDirection: "column", alignItems: msg.role === "user" ? "flex-end" : "flex-start" }}>
                {msg.role === "user" ? (
                  <div style={{ background: "rgba(194,154,108,0.1)", border: "1px solid rgba(194,154,108,0.2)", borderRadius: "12px 12px 2px 12px", padding: "13px 17px", maxWidth: "82%", color: "#e8d5b7", fontSize: "16px", lineHeight: "1.6" }}>
                    {msg.content}
                  </div>
                ) : (
                  <div style={{ maxWidth: "94%" }}>
                    <div style={{ fontFamily: "'Bebas Neue', sans-serif", fontSize: "11px", letterSpacing: "2px", color: "rgba(194,154,108,0.45)", marginBottom: "8px" }}>ONE DECISION GUIDE</div>
                    <div style={{ color: "#d4c4a8", fontSize: "16.5px", lineHeight: "1.8", whiteSpace: "pre-wrap" }}>{msg.content}</div>
                  </div>
                )}
              </div>
            ))}

            {loading && (
              <div className="message-in" style={{ display: "flex", flexDirection: "column", alignItems: "flex-start" }}>
                <div style={{ fontFamily: "'Bebas Neue', sans-serif", fontSize: "11px", letterSpacing: "2px", color: "rgba(194,154,108,0.45)", marginBottom: "8px" }}>ONE DECISION GUIDE</div>
                <div style={{ background: "rgba(255,255,255,0.04)", border: "1px solid rgba(194,154,108,0.15)", borderRadius: "12px", padding: "14px 18px", display: "flex", alignItems: "center" }}>
                  <span className="dot" /><span className="dot" /><span className="dot" />
                </div>
              </div>
            )}
            <div ref={bottomRef} style={{ height: "1px" }} />
          </div>

          <div style={{ width: "100%", maxWidth: "720px", padding: "16px 20px 24px", background: "linear-gradient(to top, #0d0b08 75%, transparent)", position: "sticky", bottom: 0 }}>
            <div className="input-box">
              <textarea
                ref={textareaRef}
                value={input}
                onChange={e => { setInput(e.target.value); adjustTextarea(); }}
                onKeyDown={handleKeyDown}
                placeholder="Describe your situation..."
                rows={1}
                style={{ flex: 1, background: "transparent", border: "none", color: "#e8d5b7", fontFamily: "'Crimson Text', Georgia, serif", fontSize: "16px", lineHeight: "1.6", minHeight: "28px", maxHeight: "120px" }}
              />
              <button className="send-btn" onClick={() => sendMessage()} disabled={!input.trim() || loading}
                style={{ width: "36px", height: "36px", borderRadius: "8px", background: "rgba(194,154,108,0.75)", border: "none", cursor: "pointer", display: "flex", alignItems: "center", justifyContent: "center", color: "#0d0b08", flexShrink: 0, transition: "background 0.2s" }}>
                <SendIcon />
              </button>
            </div>
            <div style={{ textAlign: "center", marginTop: "10px", fontSize: "12px", color: "rgba(194,154,108,0.3)" }}>
              Powered by <em>One Decision</em> · For deeper work — CoachMikeInspires@gmail.com · 916.230.0278
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
